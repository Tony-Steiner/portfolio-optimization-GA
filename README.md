# Algorithmic Hedge: S&P 500 Concentration Risk Manager

![Python](https://img.shields.io/badge/Python-3.10%2B-blue)
![Status](https://img.shields.io/badge/Status-Live%20Production-green)
![Focus](https://img.shields.io/badge/Focus-Quantitative%20Finance-orange)

## ğŸ“‰ The Problem: The "Passive" Bubble
The S&P 500 is no longer a diversified index. As of 2025, the "Magnificent Seven" tech giants comprise nearly **30% of the entire index**.

Passive investors today are not buying "the market"â€”they are unknowingly making a massive, concentrated bet on the Tech sector. This introduces significant **idiosyncratic risk**; if the AI sector corrects, the entire "safe" index collapses.

## ğŸ›¡ï¸ The Solution: Genetic Algorithm Optimization
This project implements a **Genetic Algorithm (GA)** to construct a "Survivalist" portfolio that decouples performance from the mega-cap tech cycle.

Unlike traditional Mean-Variance Optimization (which often fails due to extreme sensitivity to input assumptions), the GA evolves a portfolio through **natural selection**, optimizing for:
* **Survivorship:** Assets with proven resilience through the 2008 and 2020 crashes.
* **Equal Weighting:** Eliminating market-cap bias to capture the "average" stock performance.
* **Regime Robustness:** Maximizing Sharpe Ratio across volatile windows.

---

## ğŸ“Š Key Findings & Performance
* **Training Window:** 2006 â€“ 2015 (Capturing the 2008 Financial Crisis).
* **Testing Window:** 2016 â€“ Present (Strict Out-of-Sample).

### 1. The "Golden Age" (2016 â€“ 2023)
The model successfully identified a "Veteran" portfolio that **outperformed the Standard Swensen Benchmark** for 8 consecutive years. By favoring high-quality, non-tech incumbents, the algorithm protected capital during the 2022 Inflation Bear Market better than the S&P 500.

### 2. The "Alpha Decay" Discovery (2024 â€“ 2025)
In late 2024, the S&P 500 (Benchmark) sharply overtook the model.
* **Analysis:** This divergence signals a massive **Regime Shift**. The market moved from a "Quality/Value" regime (which the model learned from 2008-2015 data) to a "Speculative Growth" regime (AI Boom).
* **Conclusion:** This validates the **"Alpha Decay" hypothesis**â€”quantitative models must be retrained periodically to adapt to new structural market realities.

---

## ğŸ“‚ Repository Structure

```text
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ database_setup.py      # ETL Pipeline: Scrapes Banxico (CETES) & Yahoo Finance
â”‚   â”œâ”€â”€ genetic_engine.py      # The Core AI: Genetic Algorithm Class
â”‚   â””â”€â”€ metrics_engine.py      # Financial Calculations (Sharpe, Volatility, CAGR)
â”‚
â”œâ”€â”€ notebooks/
â”‚   â”œâ”€â”€ 1_Thesis_Validation.ipynb    # The "Honest" Backtest (2006-2025)
â”‚   â””â”€â”€ 2_Live_Portfolio.ipynb       # PRODUCTION: Generates this month's Buy List
â”‚
â”œâ”€â”€ requirements.txt           # Python Dependencies
â”œâ”€â”€ .env.example               # Template for Environment Variables
â””â”€â”€ README.md                  # You are here

## ğŸš€ How to Run (Production Mode)

**1. Setup Environment**
This project requires a PostgreSQL database.

* **Create the Database:** Open your SQL tool (pgAdmin or terminal) and run:
    ```sql
    CREATE DATABASE financial_db;
    ```
* **Configure Secrets:**
    ```bash
    # Rename the template file to .env
    cp .env.example .env
    ```
    (Open `.env` and verify `DB_NAME=financial_db` matches what you just created).
* **Install Dependencies:**
    ```bash
    pip install -r requirements.txt
    ```

**2. Initialize the Warehouse**
Downloads 20 years of data for 500+ assets (S&P 500 + REITs) and calculates synthetic CETES (Risk-Free) pricing.
```bash
python src/database_setup.py

**3. Generate the "Buy List"** Open notebooks/2_Live_Portfolio.ipynb.

* This notebook runs the Genetic Algorithm on current data (2015â€“Present).
* It performs a Concentration Test (comparing 15 vs. 30 stock baskets) to determine the optimal risk/reward ratio for the current month.
* Output: A list of ~20 actionable tickers (Stocks + REITs) for execution.

** ğŸ› ï¸ Key Technologies

* Core: Python, Pandas, NumPy
* Database: PostgreSQL, SQLAlchemy
* Financial Data: Yahoo Finance API (yfinance), Banxico API
* Algorithm: Evolutionary Computation (Genetic Algorithms)

**âš ï¸ Disclaimer
This software is for educational and research purposes only. I am not a financial advisor. The "Official Buy List" generated by this code is a theoretical output of a mathematical model and should not be construed as financial advice. Algorithmic trading involves substantial risk of loss.